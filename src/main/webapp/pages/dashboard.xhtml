<ui:composition xmlns="http://www.w3.org/1999/xhtml"  
	xmlns:h="http://java.sun.com/jsf/html"  
 	xmlns:f="http://java.sun.com/jsf/core"  
    xmlns:ui="http://java.sun.com/jsf/facelets"
    xmlns:p="http://primefaces.org/ui" 
    xmlns:jsf="http://xmlns.jcp.org/jsf"
    xmlns:pt="http://xmlns.jcp.org/jsf/passthrough"
   	template="/templates/main.xhtml">
   	
    <ui:define name="content">                        
        <h1 class="page-header"> 
        	<i class="fa fa-tachometer" /> 
        	Dashboard
        </h1>
        <form jsf:id="form" jsf:prependId="false" class="form-horizontal">
        	
        	<p:remoteCommand id="rmcRemove" name="rmRemover" actionListener="#{mbDashboard.setPublicacaoId}" />
        	<p:remoteCommand id="rmcStart" name="rmStart" actionListener="#{mbDashboard.setPublicacaoId}" />
        	<p:remoteCommand id="rmcStop" name="rmStop" actionListener="#{mbDashboard.setPublicacaoId}" />
        	
           	<p:remoteCommand id="rmcRemoverConfirma" name="rmConfirmaRemover" actionListener="#{mbDashboard.remover}" update="@form" onsuccess="alerta.sucesso('Publicação removida com sucesso!');" />
           	<p:remoteCommand id="rmcStopConfirma" name="rmConfirmaStop" actionListener="#{mbDashboard.stop}" update="@form" onsuccess="alerta.sucesso('Publicação pausada com sucesso!');" />
           	<p:remoteCommand id="rmcStartConfirma" name="rmConfirmaStart" actionListener="#{mbDashboard.start}" update="@form" onsuccess="alerta.sucesso('Publicação iniciada com sucesso!');" />
           	
           	<p:remoteCommand id="rmcLimpar" name="rmConfirmaLimpar" actionListener="#{mbDashboard.limpar}" />
        
        	<table class="table table-striped">
        		<tr>
        			<td>Ações</td>
        			<td>Data</td>
        			<td>Usuário</td>
        			<td>Projeto</td>
        			<td>URL</td>
        			<td>Tag</td>
        		</tr>
        		<ui:repeat var="e" value="#{mbDashboard.publicacoes}">
        			<tr>
        				<td>
		                    <button 
        						type="button" 
        						class="btn btn-danger"
        						style="font-size: 10px !important;"
        						data-toggle="modal"
        						data-target="#dlgRemocao"
        						onclick="setIdRemover('#{e.id}')">
        						<span class="glyphicon glyphicon-remove" aria-hidden="true" />
        					</button>
        					
        					<button 
        						type="button" 
        						class="btn btn-warning"
        						style="font-size: 10px !important;"
        						data-toggle="modal"
        						data-target="#dlgStop"
        						onclick="setIdStopContainer('#{e.id}')">
        						<span class="glyphicon glyphicon-pause" aria-hidden="true" />
        					</button>
        					
        					<button 
        						type="button" 
        						class="btn btn-success"
        						style="font-size: 10px !important;"
        						data-toggle="modal"
        						data-target="#dlgStart"
        						onclick="setIdStartContainer('#{e.id}')">
        						<span class="glyphicon glyphicon-play" aria-hidden="true" />
        					</button>
        					
	                    </td>
        				<td>#{e.dataFormatada}</td>
        				<td>#{e.user}</td>
        				<td>#{e.projeto}</td>
        				<td>#{e.url}</td>
        				<td>#{e.tag}</td>
        			</tr>
        		</ui:repeat>
        	</table>
        	
        	<!-- Modal Remover -->
			<div class="modal fade" id="dlgRemocao" tabindex="-1" role="dialog" aria-labelledby="dlgRemocaoLabel">
			  <div class="modal-dialog" role="document">
			    <div class="modal-content">
			      <div class="modal-header">
			        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true"></span></button>
			        <h4 class="modal-title" id="dlgRemocaoLabel">Confirma exclusão?</h4>
			      </div>
			      <div class="modal-body">
			      	Deseja realmente excluir a publicação selecionada?
			      </div>
			      <div class="modal-footer">
			        <button type="submit" 
			        	class="btn btn-default" 
			        	data-dismiss="modal"
			        	onclick="rmConfirmaLimpar();">
        				Cancelar
        			</button>
        				
			        <button type="submit" 
			        	class="btn btn-primary"
			        	data-dismiss="modal"
						onclick="rmConfirmaRemover();">
			        	Confirmar
			        </button>
			      </div>
			    </div>
			  </div>
			</div>
			
			<!-- Modal Pausar -->
			<div class="modal fade" id="dlgStop" tabindex="-1" role="dialog" aria-labelledby="dlgStopLabel">
			  <div class="modal-dialog" role="document">
			    <div class="modal-content">
			      <div class="modal-header">
			        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true"></span></button>
			        <h4 class="modal-title" id="dlgStopLabel">Confirma pausa?</h4>
			      </div>
			      <div class="modal-body">
			      	Deseja realmente pausar a publicação selecionada?
			      </div>
			      <div class="modal-footer">
			        <button type="submit" 
			        	class="btn btn-default" 
			        	data-dismiss="modal"
			        	onclick="rmConfirmaLimpar();">
        				Cancelar
        			</button>
        				
			        <button type="submit" 
			        	class="btn btn-primary"
			        	data-dismiss="modal"
			        	onclick="rmConfirmaStop();">
			        	Confirmar
			        </button>
			      </div>
			    </div>
			  </div>
			</div>
			
			<!-- Modal Iniciar -->
			<div class="modal fade" id="dlgStart" tabindex="-1" role="dialog" aria-labelledby="dlgStartLabel">
			  <div class="modal-dialog" role="document">
			    <div class="modal-content">
			      <div class="modal-header">
			        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true"></span></button>
			        <h4 class="modal-title" id="dlgStartLabel">Confirma iniciar?</h4>
			      </div>
			      <div class="modal-body">
			      	Deseja realmente iniciar a publicação selecionada?
			      </div>
			      <div class="modal-footer">
			        <button type="submit" 
			        	class="btn btn-default" 
			        	data-dismiss="modal"
			        	onclick="rmConfirmaLimpar();">
        				Cancelar
        			</button>
        				
			        <button type="submit" 
			        	class="btn btn-primary"
			        	data-dismiss="modal"
						onclick="rmConfirmaStart();">
			        	Confirmar
			        </button>
			      </div>
			    </div>
			  </div>
			</div>
			
			<script type="text/javascript">
				function setIdRemover(id) {
	       			rmRemover([{name:'id', value:id}]);
	       		}

				function setIdStopContainer(id) {
					rmStop([{name:'id', value:id}]);
				}
				
				function setIdStartContainer(id) {
					rmStart([{name:'id', value:id}]);
				}
			</script>
			
        </form>
    </ui:define>
    
</ui:composition>